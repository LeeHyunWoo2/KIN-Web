import {DocsImage} from '../../../components/docs/Image';
import dimg from "../../../lib/docsImages";

## ğŸš€ ì»¨í…ì¸  ë°ì´í„° ìµœì í™”

<div className="max-h-96 overflow-auto border-y rounded-md mt-8">

```json filename="sampleData.json"

{
  "type": "doc",
  "content": [
    {
      "type": "paragraph",
      "content": [
        {
          "type": "text",
          "text": "ì´ê²ƒì€ Plate Editorì—ì„œ ì‘ì„±ëœ ë…¸íŠ¸ì˜ ì˜ˆì œì…ë‹ˆë‹¤."
        }
      ]
    },
    {
      "type": "paragraph",
      "content": [
        {
          "type": "text",
          "text": "Plate EditorëŠ” JSON í˜•íƒœë¡œ ë¬¸ì„œë¥¼ ì €ì¥í•©ë‹ˆë‹¤."
        }
      ]
    },
    {
      "type": "bulletList",
      "content": [
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "ëª©ë¡ í•­ëª© 1"
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "ëª©ë¡ í•­ëª© 2"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "blockquote",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "ì´ê²ƒì€ ì¸ìš©ë¬¸ ì˜ˆì œì…ë‹ˆë‹¤.",
              "marks": [
                {
                  "type": "italic"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "codeBlock",
      "attrs": { "language": "javascript" },
      "content": [
        {
          "type": "text",
          "text": "console.log('Hello, World!');"
        }
      ]
    }
  ]
}


```

</div>

<span className="flex justify-center my-8">

*Plate ì—ë””í„°ëŠ” ì´ëŸ° JSON í˜•íƒœë¡œ ë°ì´í„°ë¥¼ ì €ì¥í•œë‹¤.*

</span>


### ğŸ“ ìƒí™© ì„¤ëª…
- JSONì„ ê·¸ëŒ€ë¡œ ì „ì†¡í•˜ë©´ í¬ê¸°ê°€ ì»¤ì ¸ ë„¤íŠ¸ì›Œí¬ ë¹„ìš©ì´ ì¦ê°€í•¨.
- Base64 ì¸ì½”ë”©ì„ ì‚¬ìš©í•˜ë©´ í¬ê¸°ê°€ ì˜¤íˆë ¤ ì¦ê°€í•˜ëŠ” ë¬¸ì œê°€ ë°œìƒ.
- ìµœì í™”ë¥¼ ìœ„í•´ ë‹¤ë¥¸ ì••ì¶• ë°©ì‹ì„ ì‚¬ìš©í•  í•„ìš”ê°€ ìˆìŒ.

---

## ğŸ” ë¶„ì„
1. **JSON í¬ê¸° ì¦ê°€ ë¬¸ì œ**
    - ë…¸íŠ¸ ë°ì´í„°ê°€ ì¤‘ì²©ëœ JSON êµ¬ì¡°ë¥¼ ê°€ì§€ë©°, í…ìŠ¤íŠ¸ê°€ ë§ì„ìˆ˜ë¡ í¬ê¸°ê°€ ì¦ê°€.
    - Base64 ì¸ì½”ë”©ì„ ì ìš©í•˜ë©´ ì›ë³¸ ëŒ€ë¹„ ì•½ 33% ì •ë„ ë°ì´í„° í¬ê¸°ê°€ ì¦ê°€í•¨.
    - ë°”ì´ë„ˆë¦¬ë¡œ ì••ì¶• ì‹œ, JSON í¬ê¸°ì— ë”°ë¼ ì•½ 30% ~ 70% ê°ì†Œë¥¼ ê¸°ëŒ€í•  ìˆ˜ ìˆìŒ.

2. **ë„¤íŠ¸ì›Œí¬ íŠ¸ë˜í”½ ì¦ê°€**
    - ë°ì´í„° í¬ê¸°ê°€ ì»¤ì§ˆìˆ˜ë¡ ì „ì†¡ ì†ë„ê°€ ëŠë ¤ì§€ê³ , ë¡œë”© ì„±ëŠ¥ì´ ì €í•˜ë¨.

3. **DB ë° ì„œë²„ ë¶€í•˜**
    - ì••ì¶•ë˜ì§€ ì•Šì€ ë°ì´í„°ê°€ ëˆ„ì ë ìˆ˜ë¡ DB ë° ìºì‹±ì˜ íš¨ìœ¨ì´ ë–¨ì–´ì§ˆê²ƒìœ¼ë¡œ ì˜ˆìƒ.

4. **ì²˜ë¦¬ ë¶€ë‹´ ë¶„ì‚°**
    - ë°”ì´ë„ˆë¦¬ ì••ì¶•, í•´ì œ ê³¼ì •ì—ì„œ CPU ì˜¤ë²„í—¤ë“œê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤ê³  í•œë‹¤.
    - ì‚¬ìš©ì í•œëª…ì˜ ë°ì´í„° ì •ë„ëŠ” ì „í˜€ í‹°ë‚˜ì§€ ì•ŠëŠ” ê·œëª¨ì´ê³ , ì´ ì••ì¶•/í•´ì œ ê³¼ì •ì€ ë³´ì•ˆì„ ìœ„í•œê²ƒì´ ì•„ë‹ˆë‹¤.<br/>ë”°ë¼ì„œ í´ë¼ì´ì–¸íŠ¸ê°€ ë‹´ë‹¹í•˜ë„ë¡ ì„¤ê³„í•˜ì—¬ë„ ì¢‹ë‹¤ê³  íŒë‹¨.
    - ë°±ì—”ë“œëŠ” DBë¡œ ì „ë‹¬ë§Œ í•˜ê¸° ë•Œë¬¸ì— ë¶€ë‹´ì´ ì—†ë‹¤.

---

## ğŸ› ï¸ í•´ê²° ê³¼ì •

### âœ… í•´ê²°ì±… ê°œìš”
- **zlib ì••ì¶• ì ìš©**: JSON ë°ì´í„°ë¥¼ ë°”ì´ë„ˆë¦¬ë¡œ ë³€í™˜ í›„ Gzip ì••ì¶•í•˜ì—¬ ì „ì†¡.
- **ëª¨ë“œë³„ ì••ì¶• ì§€ì›**
    - `editor` ëª¨ë“œ: Plate Editor JSONì„ ì••ì¶•/ë³µì›
    - `plaintext` ëª¨ë“œ: ì¼ë°˜ í…ìŠ¤íŠ¸ë¥¼ ì••ì¶•/ë³µì›
- **ì••ì¶•/ë³µì› í•¨ìˆ˜ ë¶„ë¦¬**
    - ì••ì¶•: `compressEditorContent`, `compressTextContent`
    - ë³µì›: `decompressEditorContent`, `decompressTextContent`


```js filename="noteCompressor.js"
import zlib from 'zlib';

export const getCompressor = (mode) => {
  return mode === 'editor' ? compressEditorContent : compressTextContent;
};

export const getDecompressor = (mode) => {
  return mode === 'editor' ? decompressEditorContent : decompressTextContent;
};

const compressEditorContent = (content) => {
  try {
    return zlib.gzipSync(JSON.stringify(content));
  } catch (error) {
    console.error('ì—ë””í„° ëª¨ë“œ ì••ì¶• ì‹¤íŒ¨', error);
    return content;
  }
};

const decompressEditorContent = (compressedContent) => {
  try {
    return JSON.parse(zlib.gunzipSync(Buffer.from(compressedContent, 'base64')));
  } catch (error) {
    console.error('ì—ë””í„° ëª¨ë“œ ë³µì› ì‹¤íŒ¨', error);
    return compressedContent;
  }
};
```

---

## âœ… ê²°ê³¼

<br/>

<DocsImage src={dimg.notes.binary}/>

<span className="flex justify-center my-8">

*(gif ë¥¼ ë”°ë¡œ ì´¬ì˜í•´ì„œ ì˜ˆì‹œ ë¬¸êµ¬ê°€ ë‹¤ë¥¸ì  ì–‘í•´ ë¶€íƒë“œë¦½ë‹ˆë‹¤.)*

</span>

<br/>

### ğŸš€ ì„±ëŠ¥ ê°œì„  íš¨ê³¼

<div className="max-h-96 overflow-auto border-y rounded-md mt-8">

```python filename="compare_note_performance.py"
import json
import base64
import zlib
import pandas as pd

plate_editor_json = {
    "type": "doc",
    "content": [
        {
            "type": "paragraph",
            "content": [
                {"type": "text", "text": "ì´ê²ƒì€ Plate Editorì—ì„œ ì‘ì„±ëœ ë…¸íŠ¸ì˜ ì˜ˆì œì…ë‹ˆë‹¤."}
            ]
        },
        {
            "type": "paragraph",
            "content": [
                {"type": "text", "text": "Plate EditorëŠ” JSON í˜•íƒœë¡œ ë¬¸ì„œë¥¼ ì €ì¥í•©ë‹ˆë‹¤."}
            ]
        },
        {
            "type": "bulletList",
            "content": [
                {
                    "type": "listItem",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {"type": "text", "text": "ëª©ë¡ í•­ëª© 1"}
                            ]
                        }
                    ]
                },
                {
                    "type": "listItem",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {"type": "text", "text": "ëª©ë¡ í•­ëª© 2"}
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "blockquote",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {"type": "text", "text": "ì´ê²ƒì€ ì¸ìš©ë¬¸ ì˜ˆì œì…ë‹ˆë‹¤.", "marks": [{"type": "italic"}]}
                    ]
                }
            ]
        },
        {
            "type": "codeBlock",
            "attrs": {"language": "javascript"},
            "content": [
                {"type": "text", "text": "console.log('Hello, World!');"}
            ]
        }
    ]
}


# JSON ë°ì´í„°ë¥¼ ë¬¸ìì—´ë¡œ ë³€í™˜
json_str = json.dumps(plate_editor_json, ensure_ascii=False)

# 1. JSON ê·¸ëŒ€ë¡œ í¬ê¸° (UTF-8)
json_bytes = json_str.encode('utf-8')
json_size = len(json_bytes)

# 2. Base64ë¡œ ë³€í™˜ í›„ í¬ê¸°
base64_encoded = base64.b64encode(json_bytes)
base64_size = len(base64_encoded)

# 3. ë°”ì´ë„ˆë¦¬ ì••ì¶• (zlib ì‚¬ìš©)
compressed_binary = zlib.compress(json_bytes)
compressed_size = len(compressed_binary)

# ê²°ê³¼ ë¹„êµ
comparison_results = {
    "JSON (ì›ë³¸)": json_size,
    "Base64 ë³€í™˜": base64_size,
    "ë°”ì´ë„ˆë¦¬ ì••ì¶• (zlib)": compressed_size,
}

# ê²°ê³¼ í‘œì‹œ
df = pd.DataFrame(list(comparison_results.items()), columns=["ë°©ì‹", "í¬ê¸° (ë°”ì´íŠ¸)"])
print(df)

```

</div>

<span className="flex justify-center my-8">

*ìš©ëŸ‰ ê³„ì‚° íŒŒì´ì¬ ìŠ¤í¬ë¦½íŠ¸*

</span>

<br/>

| ì „ì†¡ ë°©ì‹ | ë°ì´í„° í¬ê¸° (ì˜ˆì œ ê¸°ì¤€) |
|-----------|------------------|
| JSON (ì›ë³¸) | 853 ë°”ì´íŠ¸ |
| Base64 ë³€í™˜ | 1140 ë°”ì´íŠ¸ (33.65% ì¦ê°€) |
| Gzip ì••ì¶• | 334 ë°”ì´íŠ¸ (60.84% ê°ì†Œ) |

- ì••ì¶• ì ìš© í›„ ì „ì†¡ ë°ì´í„° í¬ê¸°ê°€ **í‰ê·  5~60% ê°ì†Œ**
- ë„¤íŠ¸ì›Œí¬ íŠ¸ë˜í”½ ë° ë¡œë”© ì†ë„ ìµœì í™”
- DB ì €ì¥ ê³µê°„ ì ˆì•½

---

## ğŸ’¡ ë°°ìš´ ì 
- JSON ë°ì´í„°ë¥¼ ë°”ì´ë„ˆë¦¬ ì••ì¶•í•˜ë©´ í° ì„±ëŠ¥ í–¥ìƒì„ ê¸°ëŒ€í•  ìˆ˜ ìˆìŒ.
- Base64 ë³€í™˜ì€ ì˜¤íˆë ¤ í¬ê¸°ë¥¼ ì¦ê°€ì‹œí‚¤ë¯€ë¡œ í”¼í•˜ëŠ” ê²ƒì´ ì¢‹ìŒ.
- ë°ì´í„° ì €ì¥ ë° ì „ì†¡ ìµœì í™”ë¥¼ ìœ„í•´ ë‹¤ì–‘í•œ ì••ì¶• ê¸°ë²•ì„ ê³ ë ¤í•  í•„ìš”ê°€ ìˆìŒ.